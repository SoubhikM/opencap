Q-Chem Interface {#qchem}
=============================

[Q-Chem](https://manual.q-chem.com) is a widely used quantum chemistry package with a variety of open-shell and excited state electronic structure methods. We officially support an interface with EOM-CC calculations performed by Q-Chem. There is also an experimental TDDFT interface. 

System
======

OpenCAP can extract the basis set from .fchk files generated by Q-Chem.

__Relevant keywords__
| Keyword    | Valid options                     | Description                                                                                                                                                                                                                                                                                      |
|------------|-----------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| molecule   | molden,rassi_h5,inline,qchem_fchk | Specifies which format to read the molecular geometry. If "inline" is chosen, the "$geometry" section is also required.                                                                                                                                                                          |
| basis_file | path to basis file                | Specifies the path to the basis file. When "molecule" is set to "molden","rassi_h5", or "qchem_fchk", this keyword should be set to a path to a file of the specified type. When "molecule" is set to  "inline", this keyword should be set to a path to a basis set file formatted in "Psi4" style. |

Projected CAP
=============

Densities can be read in from .fchk files, and the zeroth order Hamiltonian can be read from 
Q-Chem output files for EOM-CC calculations. To export the full densities to .fchk, GUI=2 
must be set in the $rem card, and PROJ_CAP=3 must be set in the 
$complex_ccman card. See the [Q-Chem manual](https://manual.q-chem.com/latest/sub_cc_cs_cap.html) for more details.

Separate alpha/beta densities and spin traced one particle densities are both supported, and 
are automatically detected by OpenCAP.

__Relevant keywords__
| Keyword | Type | Description |
|---------------|--------|---------------------------------------------------------|
| qchem_fchk | string | Relative or absolute path to .fchk file containing TDMs.     |
| qchem_output | string | Relative or absolute path to Q-Chem output file.   |
| h0_file | string | Relative or absolute path to properly formatted zeroth order Hamiltonian file.   |


__Example input__

    $system
    molecule qchem_fchk
    basis_file qc_input.fchk
    $end

    $projected_cap
    method eom
    package qchem
    qchem_fchk qc_input.fchk
    nstates 10
    CAP_TYPE voronoi
    R_CUT 3.00
    Radial_precision  14
    Angular_points    110
    $end
    
